this modify from xugangfeng
add some info from koffuxu/master
